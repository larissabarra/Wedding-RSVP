<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets API with Apps Script</title>
</head>
<body>
    <h1>Google Sheets Data</h1>
    
    <!-- Fetch Data Form -->
    <form id="fetchForm">
        <label for="row">Row Number:</label>
        <input type="number" id="row" required>
        <button type="submit">Fetch Data</button>
    </form>

    <div id="sheetData"></div>

    <h2>Update Google Sheet</h2>
    <!-- Update Data Form -->
    <form id="updateForm">
        <label for="updateRow">Row:</label>
        <input type="number" id="updateRow" required><br>
        <label for="column">Column (A, B, C, etc.):</label>
        <input type="text" id="column" required><br>
        <label for="value">New Value:</label>
        <input type="text" id="value" required><br>
        <button type="submit">Update</button>
    </form>

    <script>
        // Fetch data from Google Sheets
        document.getElementById('fetchForm').onsubmit = async function(event) {
            event.preventDefault();
            const row = document.getElementById('row').value;
            const response = await fetch('https://script.google.com/macros/s/AKfycbyBYcqVMtQw34WYwm3Mow2L6ry4oD4DwAEeKzHpFA2ce6sfoIOfDII3wqfCsxZ_78fTFw/exec?row=' + row);
            const data = await response.json();
            const sheetDataDiv = document.getElementById('sheetData');

            if (data && data.length > 0) {
                const rowData = data[0].join(' | ');  // Join array elements for display
                sheetDataDiv.innerHTML = `<p>Data for Row ${row}: ${rowData}</p>`;
            } else {
                sheetDataDiv.innerHTML = '<p>No data found for the specified row.</p>';
            }
        };

        // Submit form to update Google Sheets
        document.getElementById('updateForm').onsubmit = async function(event) {
            event.preventDefault();

            const row = document.getElementById('updateRow').value;
            const column = document.getElementById('column').value;
            const value = document.getElementById('value').value;

            const response = await fetch('https://script.google.com/macros/s/AKfycbyBYcqVMtQw34WYwm3Mow2L6ry4oD4DwAEeKzHpFA2ce6sfoIOfDII3wqfCsxZ_78fTFw/exec', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ row, column, value })
            });

            const result = await response.json();
            alert(result.message);  // Notify the user of the update status
        };
    </script>
</body>
</html>
