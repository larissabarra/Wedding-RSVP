<!DOCTYPE html>
<html>
<head>
    <title>Read and Write to Google Sheet</title>
</head>
<body>
    <h1>Read and Write to Google Sheet aaaa</h1>
    
    <div id="data"></div>
    <input type="text" id="valueInput" placeholder="Enter value to write">
    <button onclick="updateData(2)">Submit</button>

    <script>
        const webAppUrl = 'https://script.google.com/macros/s/AKfycbyBYcqVMtQw34WYwm3Mow2L6ry4oD4DwAEeKzHpFA2ce6sfoIOfDII3wqfCsxZ_78fTFw/exec';

        function fetchData(row) {
            fetch(`${webAppUrl}?row=${row}`)
                .then(response => response.json())
                .then(data => {
                    document.getElementById('data').innerText = JSON.stringify(data);
                })
                .catch(error => console.error('Error:', error));
        }

        function updateData(row) {
            const value = document.getElementById('valueInput').value;

            fetch(webAppUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `row=${row}&value=${value}`
            })
            .then(response => response.text())
            .then(data => {
                console.log('Update success:', data);
                fetchData(row); // Fetch updated data to display
            })
            .catch(error => console.error('Error:', error));
        }

        // Fetch data initially from row 2
        fetchData(2);
    </script>
</body>
</html>
